<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Resume Parser - Modern Layout</title>
  <link rel="icon" href="https://cdn-icons-png.flaticon.com/512/833/833472.png">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.2/html2pdf.bundle.min.js"></script>

  <style>
    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: 'Segoe UI', sans-serif;
      background: #f0f2f5;
      color: #333;
    }

    .resume {
      display: flex;
      max-width: 960px;
      margin: 40px auto;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }

    .left {
      width: 30%;
      background-color: #2f3542;
      color: #fff;
      padding: 30px 20px;
    }

    .right {
      width: 70%;
      background-color: #fff;
      padding: 30px 40px;
    }

    h1 {
      margin-top: 0;
      font-size: 24px;
      text-transform: uppercase;
    }

    .info {
      font-size: 14px;
      line-height: 1.6;
      margin-bottom: 20px;
    }

    .section-title {
      font-weight: bold;
      font-size: 16px;
      margin: 30px 0 10px;
      text-transform: uppercase;
      border-bottom: 2px solid #007bff;
      padding-bottom: 4px;
    }

    .section-content {
      font-size: 14px;
      line-height: 1.6;
    }

    .skills ul {
      padding-left: 20px;
      margin: 0;
    }

    .skills li {
      margin-bottom: 6px;
    }

    .download-btn {
      text-align: center;
      margin: 30px;
    }

    .download-btn button {
      padding: 10px 20px;
      font-size: 16px;
      background: #007bff;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      transition: background 0.3s ease;
    }

    .download-btn button:hover {
      background: #0056b3;
    }
  </style>
</head>
<body>

  <div class="resume" id="resumeContent">

    <div class="left">
      <h1 id="name">Name</h1>
      <div class="info" id="email">üìß Email</div>
      <div class="info" id="phone">üìû Phone</div>

      <div class="section-title">Skills</div>
      <div class="skills" id="skills">
        <ul><li>Loading...</li></ul>
      </div>
    </div>

    <div class="right">
      <div class="section-title">Summary</div>
      <div class="section-content" id="summary">
        Loading summary...
      </div>

      <div class="section-title">Education</div>
      <div class="section-content" id="education">
        Loading education...
      </div>
    </div>
  </div>

  <div class="download-btn">
    <button onclick="downloadPDF()">‚¨áÔ∏è Download as PDF</button>
  </div>

  <script>
    function extractDetails(text) {
      const details = {};
      const lines = text.split('\n').map(l => l.trim()).filter(Boolean);
      let name = "Not found";
      for (const line of lines) {
        if (/^[A-Z\s\.]+$/.test(line) && line.length > 3) {
          name = line;
          break;
        }
      }
      details.Name = name;

      const emailMatch = text.match(/[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-z]{2,}/);
      details.Email = emailMatch ? emailMatch[0] : "Not found";

      const phoneMatch = text.match(/(\+?\d{1,4}[\s-]?)?(\d{10}|\d{3}[\s-]\d{3}[\s-]\d{4})/);
      details.Phone = phoneMatch ? phoneMatch[0] : "Not found";

      const skillsMatch = text.match(/Skills?\s*[:\-]?\s*([\s\S]*?)(?:\n\n|$)/i);
      details.Skills = skillsMatch ? skillsMatch[1].split(/,|\n/).map(s => s.trim()).filter(Boolean) : ["Not found"];

      const educationMatch = text.match(/Education\s*[:\-]?\s*([\s\S]*?)(?:\n\n|$)/i);
      details.Education = educationMatch ? educationMatch[1].trim() : "Not found";

      const summaryMatch = text.match(/Summary\s*[:\-]?\s*([\s\S]*?)(?:\n\n|$)/i);
      details.Summary = summaryMatch ? summaryMatch[1].trim() : "Not found";

      return details;
    }

    const resumeText = localStorage.getItem('resumeText');
    if (resumeText) {
      const details = extractDetails(resumeText);

      document.getElementById("name").textContent = details.Name;
      document.getElementById("email").textContent = `üìß ${details.Email}`;
      document.getElementById("phone").textContent = `üìû ${details.Phone}`;
      document.getElementById("summary").textContent = details.Summary;
      document.getElementById("education").textContent = details.Education;

      const skillsList = details.Skills.map(skill => `<li>${skill}</li>`).join("");
      document.getElementById("skills").innerHTML = `<ul>${skillsList}</ul>`;
    } else {
      document.getElementById("summary").textContent = "No resume text found. Please upload from the previous page.";
    }

    function downloadPDF() {
  const element = document.getElementById("resumeContent");
  const name = document.getElementById("name").textContent.trim().replace(/\s+/g, '_');
  const filename = name !== "Name" ? `${name}_Resume.pdf` : "resume_parsed_output.pdf";

  const opt = {
    margin: 0.5,
    filename: filename,
    image: { type: 'jpeg', quality: 0.98 },
    html2canvas: { scale: 2 },
    jsPDF: { unit: 'in', format: 'letter', orientation: 'portrait' }
  };

  html2pdf().set(opt).from(element).save();
}

  </script>

</body>
</html>
